import{r as d,j as e}from"./index-ujZ2fpNt.js";const f=({onSubmit:i,error:t})=>{const[a,r]=d.useState(""),n=l=>{l.preventDefault(),a.length===6&&i(a)};return e.jsx("div",{className:"flex items-center justify-center h-screen bg-black text-white",children:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"WinTerm Bridge"}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsx("p",{className:"text-gray-400 mb-4",children:"Enter the PIN shown on the server"}),e.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:6,value:a,onChange:l=>r(l.target.value.replace(/\D/g,"")),className:"w-48 px-4 py-3 text-center text-2xl font-mono bg-gray-800 border border-gray-600 rounded focus:outline-none focus:border-green-500",placeholder:"000000",autoFocus:!0}),t&&e.jsx("p",{className:"text-red-500 text-sm",children:t}),e.jsx("button",{type:"submit",disabled:a.length!==6,className:"w-full py-3 bg-green-600 hover:bg-green-700 disabled:bg-gray-700 disabled:text-gray-500 rounded font-bold transition-colors",children:"Connect"})]})]})})};function m(i){const t=new Date(i),r=new Date().getTime()-t.getTime(),n=Math.floor(r/1e3);return n<60?"just now":n<3600?`${Math.floor(n/60)}m ago`:n<86400?`${Math.floor(n/3600)}h ago`:`${Math.floor(n/86400)}d ago`}const y=({sessions:i,onSelect:t,onCreate:a,onDelete:r,onLogout:n})=>{const[l,c]=d.useState(""),h=(s,o)=>{s.stopPropagation(),confirm("Are you sure you want to delete this session?")&&r(o)},x=(s,o)=>{s.stopPropagation(),navigator.clipboard.writeText(o).then(()=>{alert("Tmux command copied to clipboard!")}).catch(()=>{alert("Failed to copy: "+o)})},u=()=>{a(l.trim()||void 0),c("")};return e.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-black text-white p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Select Session"}),e.jsx("button",{onClick:n,className:"text-sm text-gray-400 hover:text-white transition-colors",children:"Logout"})]}),e.jsx("div",{className:"space-y-3 mb-6 max-h-[60vh] overflow-y-auto",children:i.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-900 rounded-lg border border-gray-800",children:"No active sessions found"}):i.map(s=>e.jsx("div",{className:"bg-gray-900 border border-gray-800 rounded-lg p-4 hover:border-green-600 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-mono text-lg font-bold text-gray-200",children:s.title||`Session ${s.id.substring(0,8)}`}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex items-center gap-2",children:[e.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${s.state==="active"?"bg-green-500":"bg-yellow-500"}`}),e.jsx("span",{children:s.state}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:m(s.last_active)})]}),s.tmux_name&&e.jsxs("div",{className:"text-xs text-gray-600 mt-2 font-mono",children:["tmux: ",s.tmux_name]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.tmux_cmd&&e.jsx("button",{onClick:o=>x(o,s.tmux_cmd),className:"bg-gray-800 hover:bg-blue-600 text-gray-400 hover:text-white px-3 py-2 rounded transition-colors",title:"Copy tmux attach command",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),e.jsx("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"})]})}),e.jsx("button",{onClick:o=>h(o,s.id),className:"bg-gray-800 hover:bg-red-600 text-gray-400 hover:text-white px-3 py-2 rounded transition-colors",title:"Delete session",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:()=>t(s.id),className:"bg-gray-800 hover:bg-green-600 text-gray-300 hover:text-white px-4 py-2 rounded font-medium transition-colors",children:"Join"})]})]})},s.id))}),e.jsxs("div",{className:"border-t border-gray-800 pt-6 space-y-3",children:[e.jsx("input",{type:"text",value:l,onChange:s=>c(s.target.value),placeholder:"Session name (optional)",className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded text-white placeholder-gray-500 focus:outline-none focus:border-green-500"}),e.jsxs("button",{onClick:u,className:"w-full py-3 bg-green-600 hover:bg-green-700 text-white rounded font-bold transition-colors flex items-center justify-center space-x-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),e.jsx("span",{children:"Create New Session"})]})]})]})})};class g{getAuthHeaders(t=!1){const a=localStorage.getItem("winterm_token"),r={};return a&&(r.Authorization=`Bearer ${a}`),t&&(r["Content-Type"]="application/json"),r}async handleResponse(t){if(!t.ok){const a=await t.json().catch(()=>({error:"Unknown error"}));throw new Error(a.error||`HTTP error ${t.status}`)}return t.status===204?{}:t.json()}async authenticate(t){const a=await fetch("/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pin:t})});return this.handleResponse(a)}async validateToken(){if(!localStorage.getItem("winterm_token"))return{valid:!1};try{const a=await fetch("/api/auth/validate",{method:"POST",headers:this.getAuthHeaders()});return this.handleResponse(a)}catch{return{valid:!1}}}async listSessions(){const t=await fetch("/api/sessions",{method:"GET",headers:this.getAuthHeaders()});return this.handleResponse(t)}async createSession(t){const a={};t!=null&&t.title&&(a.title=t.title),t!=null&&t.workingDirectory&&(a.working_directory=t.workingDirectory);const r=await fetch("/api/sessions",{method:"POST",headers:this.getAuthHeaders(!0),body:JSON.stringify(a)});return this.handleResponse(r)}async deleteSession(t){const a=await fetch(`/api/sessions/${t}`,{method:"DELETE",headers:this.getAuthHeaders()});await this.handleResponse(a)}async attachSession(t){const a=await fetch(`/api/sessions/${t}/attach`,{method:"POST",headers:this.getAuthHeaders()});return this.handleResponse(a)}}const b=new g;export{f as A,y as S,b as a};
